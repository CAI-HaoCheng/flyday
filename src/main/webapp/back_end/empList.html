<!DOCTYPE html>
<html lang="en">
<head>
<title>Flyday - 員工管理系統</title>

<!-- Meta Tags -->
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Webestica.com">
<meta name="description"
	content="Booking - Multipurpose Online Booking Theme">

<!-- Dark mode -->
<script>
		const storedTheme = localStorage.getItem('theme')
 
		const getPreferredTheme = () => {
			if (storedTheme) {
				return storedTheme
			}
			return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
		}

		const setTheme = function (theme) {
			if (theme === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches) {
				document.documentElement.setAttribute('data-bs-theme', 'dark')
			} else {
				document.documentElement.setAttribute('data-bs-theme', theme)
			}
		}

		setTheme(getPreferredTheme())

		window.addEventListener('DOMContentLoaded', () => {
		    var el = document.querySelector('.theme-icon-active');
			if(el != 'undefined' && el != null) {
				const showActiveTheme = theme => {
				const activeThemeIcon = document.querySelector('.theme-icon-active use')
				const btnToActive = document.querySelector(`[data-bs-theme-value="${theme}"]`)
				const svgOfActiveBtn = btnToActive.querySelector('.mode-switch use').getAttribute('href')

				document.querySelectorAll('[data-bs-theme-value]').forEach(element => {
					element.classList.remove('active')
				})

				btnToActive.classList.add('active')
				activeThemeIcon.setAttribute('href', svgOfActiveBtn)
			}

			window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
				if (storedTheme !== 'light' || storedTheme !== 'dark') {
					setTheme(getPreferredTheme())
				}
			})

			showActiveTheme(getPreferredTheme())

			document.querySelectorAll('[data-bs-theme-value]')
				.forEach(toggle => {
					toggle.addEventListener('click', () => {
						const theme = toggle.getAttribute('data-bs-theme-value')
						localStorage.setItem('theme', theme)
						setTheme(theme)
						showActiveTheme(theme)
					})
				})

			}
		})
		
	</script>

<!-- Favicon -->
<link rel="shortcut icon" href="assets/images/favicon.ico">

<!-- Google Font -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Poppins:wght@400;500;700&display=swap">

<!-- Plugins CSS -->
<link rel="stylesheet" type="text/css"
	href="assets/vendor/font-awesome/css/all.min.css">
<link rel="stylesheet" type="text/css"
	href="assets/vendor/bootstrap-icons/bootstrap-icons.css">
<link rel="stylesheet" type="text/css"
	href="assets/vendor/overlay-scrollbar/css/overlayscrollbars.min.css">
<link rel="stylesheet" type="text/css"
	href="assets/vendor/choices/css/choices.min.css">

<!-- Theme CSS -->
<link rel="stylesheet" type="text/css" href="assets/css/style.css">

</head>

<body>

	<!-- **************** MAIN CONTENT START **************** -->
	<main>

		<!-- Sidebar START -->
		<nav class="navbar sidebar navbar-expand-xl navbar-light">
			<!-- Navbar brand for xl START -->
			<div class="d-flex align-items-center">
				<a class="navbar-brand" href="../front_end/index.html"> <img
					class="light-mode-item navbar-brand-item" src="myassets/logo.svg"
					alt="logo"> <img class="dark-mode-item navbar-brand-item"
					src="myassets/logo.svg" alt="logo"> <h>返回銷售首頁</h>
				</a>
			</div>
			<!-- Navbar brand for xl END -->

			<div
				class="offcanvas offcanvas-start flex-row custom-scrollbar h-100"
				data-bs-backdrop="true" tabindex="-1" id="offcanvasSidebar">
				<div class="offcanvas-body sidebar-content d-flex flex-column pt-4">

					<!-- Sidebar footer START -->
					<div
						class="d-flex align-items-center justify-content-between text-primary-hover mt-auto p-3">
						<a class="h6 fw-light mb-0 text-body"
							href="../back_end/login.html" data-bs-toggle="tooltip"
							data-bs-placement="top" aria-label="Sign out"> <i
							class="fa-solid fa-arrow-right-from-bracket"></i> 登出員工系統
						</a>
					</div>
					<!-- Sidebar footer END -->

				</div>
			</div>
		</nav>
		<!-- Sidebar END -->

		<!-- Page content START -->
		<div class="page-content">

			<!-- Top bar START -->
			<nav class="navbar top-bar navbar-light py-0 py-xl-3">
				<div class="container-fluid p-0">
					<div class="d-flex align-items-center w-100">

						<!-- Logo START -->
						<div class="d-flex align-items-center d-xl-none">
							<a class="navbar-brand" href="../front_end/index.html"> <img
								class="navbar-brand-item h-40px" src="myassets/logo.svg" alt="">
							</a>
						</div>
						<!-- Logo END -->

						<!-- Toggler for sidebar START -->
						<div class="navbar-expand-xl sidebar-offcanvas-menu">
							<button class="navbar-toggler me-auto p-2" type="button"
								data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar"
								aria-controls="offcanvasSidebar" aria-expanded="false"
								aria-label="Toggle navigation" data-bs-auto-close="outside">
								<i class="bi bi-list text-primary fa-fw"
									data-bs-target="#offcanvasMenu"></i>
							</button>
						</div>
						<!-- Toggler for sidebar END -->

						<!-- Top bar left -->
						<div class="navbar-expand-lg ms-auto ms-xl-0">
							<!-- Topbar menu START -->
							<div class="collapse navbar-collapse w-100 z-index-1"
								id="navbarTopContent"></div>
							<!-- Topbar menu END -->
						</div>
						<!-- Top bar left END -->

						<!-- Top bar right START -->
						<ul
							class="nav flex-row align-items-center list-unstyled ms-xl-auto">
							<!-- Dark mode options START -->
							<li class="nav-item dropdown ms-3">
								<button class="nav-notification lh-0 btn btn-light p-0 mb-0"
									id="bd-theme" type="button" aria-expanded="false"
									data-bs-toggle="dropdown" data-bs-display="static">
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
										fill="currentColor"
										class="bi bi-circle-half fa-fw theme-icon-active"
										viewBox="0 0 16 16">
									<path
											d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z" />
									<use href="#"></use>
								</svg>
								</button>

								<ul class="dropdown-menu min-w-auto dropdown-menu-end"
									aria-labelledby="bd-theme">
									<li class="mb-1">
										<button type="button"
											class="dropdown-item d-flex align-items-center"
											data-bs-theme-value="light">
											<svg width="16" height="16" fill="currentColor"
												class="bi bi-brightness-high-fill fa-fw mode-switch me-1"
												viewBox="0 0 16 16">
											<path
													d="M12 8a4 4 0 1 1-8 0 4 4 0 0 1 8 0zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z" />
											<use href="#"></use>
										</svg>
											Light
										</button>
									</li>
									<li class="mb-1">
										<button type="button"
											class="dropdown-item d-flex align-items-center"
											data-bs-theme-value="dark">
											<svg xmlns="http://www.w3.org/2000/svg" width="16"
												height="16" fill="currentColor"
												class="bi bi-moon-stars-fill fa-fw mode-switch me-1"
												viewBox="0 0 16 16">
											<path
													d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z" />
											<path
													d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z" />
											<use href="#"></use>
										</svg>
											Dark
										</button>
									</li>
									<li>
										<button type="button"
											class="dropdown-item d-flex align-items-center active"
											data-bs-theme-value="auto">
											<svg xmlns="http://www.w3.org/2000/svg" width="16"
												height="16" fill="currentColor"
												class="bi bi-circle-half fa-fw mode-switch"
												viewBox="0 0 16 16">
											<path
													d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z" />
											<use href="#"></use>
										</svg>
											Auto
										</button>
									</li>
								</ul>
							</li>
							<!-- Dark mode options END-->

						</ul>
						<!-- Top bar right END -->
					</div>
				</div>
			</nav>
			<!-- Top bar END -->

			<!-- Page main content START -->
			<div class="page-content-wrapper p-xxl-4">

				<!-- Title -->
				<div class="row">
					<div class="col-12 mb-4 mb-sm-5">
						<div class="d-sm-flex justify-content-between align-items-center">
							<h1 class="h3 mb-3 mb-sm-0">員工清單</h1>
						</div>
					</div>
				</div>

				<!-- Filters START -->
				<div class="row g-4 align-items-center justify-content-between">
					<!-- Tabs -->
					<div class="col-lg-6">
						<ul class="nav nav-pills-shadow nav-responsive">
							<li class="nav-item">
								<button class="nav-link mb-0 active" data-bs-toggle="tab"
									href="#tab-1" type="button" name="action" vaule="empListAll"
									id="empListAll">所有登錄員工</button>
							</li>
							<li class="nav-item">
								<a class="nav-link mb-0 navbar-brand"  href="empsign-up.html"
								data-bs-toggle="tab" href="#tab-4" id="addemp">新增員工</a>
							</li>
						</ul>
					</div>

					<!-- Search搜尋，找EMP_NO -->
					<div class="col-md-6 col-lg-3">
						<form class="rounded position-relative" id="empsearch">
							<input class="form-control bg-transparent" type="search"
								placeholder="搜尋員工編號" aria-label="Search" id="empsearch_input">
							<button
								class="bg-transparent p-2 position-absolute top-50 end-0 translate-middle-y border-0 text-primary-hover text-reset"
								type="submit">
								<i class="fas fa-search fs-6"></i>
							</button>
						</form>
					</div>
					<div class="mb-3 d-sm-flex justify-content-between">
						<!--錯誤訊息-->
						<div id="errMsg" class="error text-danger"></div>
					</div>

				</div>
				<!-- Filters END -->

				<!-- Guest list START -->
				<div class="card shadow mt-5">
					<!-- Card body START -->
					<div class="card-body">
						<!-- Table head -->
						<div class="bg-light rounded p-3 d-none d-lg-block">
							<div class="row row-cols-7 g-4">
								<div class="col-2">
									<h6 class="mb-0">員工編號</h6>
								</div>
								<div class="col-2">
									<h6 class="mb-0">員工姓名</h6>
								</div>
								<div class="col-2">
									<h6 class="mb-0">員工帳號</h6>
								</div>
								<div class="col-2">
									<h6 class="mb-0">員工密碼</h6>
								</div>
								<div class="col-2">
									<h6 class="mb-0">在職狀態</h6>
								</div>
								<div class="col-2">
									<h6 class="mb-0">員工資料更動</h6>
								</div>
							</div>
						</div>

						<!-- Table data -->
						<div id="employeesContainer"></div>


						<!-- ============================================ -->
						<!-- Table data -->
						<div
							class="row row-cols-xl-7 align-items-lg-center border-bottom g-4 px-2 py-4"
							id="allEmployeesTable">
							<!-- Data item -->
							<div class="col-6 col-lg-2">
								<small class="d-block d-lg-none">員工編號:</small>
								<!-- EMP_NO -->
								<span id="displayEmpNo"></span>
							</div>
							<!-- Data item -->
							<div class="col-6 col-lg-2">
								<small class="d-block d-lg-none">員工姓名:</small>
								<div class="d-flex align-items-center">
									<!-- Avatar -->
									<div class="avatar avatar-xs flex-shrink-0">
										<!-- 員工照片(未建立) -->
										<!-- 										<img class="avatar-img rounded-circle" -->
										<!-- 											src="assets/images/avatar/09.jpg" alt="avatar"> -->
									</div>
									<!-- Info -->
									<div class="ms-2">
										<!-- EMP_NAME -->
										<span id="displayEmpName"></span>
									</div>
								</div>
							</div>

							<!-- Data item -->
							<div class="col-6 col-lg-2">
								<small class="d-block d-lg-none">員工帳號：</small>
								<!-- EMP_ACC -->
								<span id="displayEmpAcc"></span>
							</div>

							<!-- Data item -->
							<div class="col-6 col-lg-2">
								<small class="d-block d-lg-none">員工密碼</small>
								<!-- EMP_PWD -->
								<span id="displayEmpPwd"></span>
							</div>



							<!-- Data item -->
							<div class="col-6 col-lg-2">
								<small class="d-block d-lg-none">在職狀態</small>
								<!-- EMP_STATUS -->
								<span id="displayEmpStatus"></span>
							</div>
						</div>
						<!-- =============================================================== -->


						<!-- Card footer START -->
						<div class="card-footer pt-0">
							<!-- Pagination and content -->
							<div
								class="d-sm-flex justify-content-sm-between align-items-sm-center">
								<!-- Content -->
								<p class="mb-sm-0 text-center text-sm-start">顯示第1筆至第?筆資料</p>
								<!-- Pagination -->
								<nav class="mb-sm-0 d-flex justify-content-center"
									aria-label="navigation">
									<ul
										class="pagination pagination-sm pagination-primary-soft mb-0">
										<li class="page-item disabled"><a class="page-link"
											href="#" tabindex="-1">前一頁</a></li>
										<li class="page-item active"><a class="page-link"
											href="#">1</a></li>
										<!-- 											此行凸顯第一頁 -->
										<li class="page-item disabled"><a class="page-link"
											href="#">..</a></li>
										<li class="page-item"><a class="page-link" href="#">15</a></li>
										<li class="page-item"><a class="page-link" href="#">下一頁</a>
										</li>
									</ul>
								</nav>
							</div>
						</div>
						<!-- Card footer END -->
					</div>
					<!-- Guest list END -->
				</div>
				<!-- Page main content END -->
			</div>
			<!-- Page content END -->
	</main>
	<!-- **************** MAIN CONTENT END **************** -->

	<!-- Bootstrap JS -->
	<script src="assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

	<!-- Vendor -->
	<script
		src="assets/vendor/overlay-scrollbar/js/overlayscrollbars.min.js"></script>
	<script src="assets/vendor/choices/js/choices.min.js"></script>

	<!-- ThemeFunctions -->
	<!-- 	單一員工查詢 -->
	<script>
	const empSearch_input = document.getElementById('empsearch_input');
	const empSearchForm = document.getElementById('empsearch');
	const container = document.querySelector('.row');
	const allEmployeesTable = document.getElementById('allEmployeesTable');
	const ela = document.getElementById('empListAll');
	const addEmp = document.getElementById('addemp');
	const currentData = {};

	//跳轉至新增員工頁面
	addEmp.addEventListener("click", function () {
		location = "empsign-up.html";
	});

	// 單一員工查詢
	empSearchForm.addEventListener("submit", async function (event) {
		event.preventDefault();  // 阻止表單的預設提交行為
		//在發送 fetch 請求之前清空 allEmployeesTable 的內容
		allEmployeesTable.innerHTML = '';
		const empNo = empSearch_input.value;

		sessionStorage.setItem('empSearch_input', empNo); // 儲存empNo而不是DOM元素

		fetch("/flyday/emp/controller", {
			method: "POST",
			headers: {
				"Content-Type": "application/json"
			},
			body: JSON.stringify({
				EMP_NO: empNo
			})
		})
			.then(response => {
				// 檢查回應是否成功。如果statusCode在200-299之間，表示成功。
				if (!response.ok) {
					throw new Error('網路連線異常，請確認網路通暢');
				}
				return response.json();  // 解析回應內容為JSON
			})
			.then(data => {
				// 在這裡新增查詢的員工資料到allEmployeesTable
				const empRow = document.createElement('div');
				empRow.classList.add('row', 'row-cols-7', 'g-4', 'employee-row');

				empRow.innerHTML = `
	            <div class="col-2 empNo">${data.empNo}</div>
	            <div class="col-2">${data.empName}</div>
	            <div class="col-2">${data.empAcc}</div>
	            <div class="col-2">${data.empPwd}</div>
	            <div class="col-2">${data.empStatus}</div>
	            <div class="col-2">
	            	<a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-edit">修改</a>
	            	<a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-delete">刪除</a>
	            	<a href="admin-guest-detail.html" class="btn btn-sm btn-light mb-0 btn-funtion">員工權限</a>
	            </div>
	        `;
				allEmployeesTable.appendChild(empRow);
				//       console.log(data);  // 打印返回的數據
				// 如果你想更新頁面的某些部分，你可以在這裡添加代碼
			})
			.catch(error => {
				// 這裡處理任何在上述代碼中發生的錯誤
				console.error('There was a problem with the fetch operation:', error.message);
			});
	});
	// 員工清單查詢

	ela.addEventListener("click", async function (event) {
		// 在發送 fetch 請求之前清空 allEmployeesTable 的內容
		allEmployeesTable.innerHTML = '';
		fetch("/flyday/emp/controller")
			.then(response => {
				if (!response.ok) {
					throw new Error('網路連線異常，請確認網路通暢');
				}
				return response.json();  // 解析回應內容為JSON
			})
			.then(data => {
				// data 是一個包含所有員工的陣列
				// 清空現有的表格內容
				//         allEmployeesTable.innerHTML = '';
				data.forEach(emp => {
					const empRow = document.createElement('div');
					empRow.classList.add('row', 'row-cols-7', 'g-4', 'employee-row'); // 可以自行增減class來適應你的CSS需求

					empRow.innerHTML = `
	                <div class="col-2 empNo">${emp.empNo}</div>
	                <div class="col-2">${emp.empName}</div>
	                <div class="col-2">${emp.empAcc}</div>
	                <div class="col-2">${emp.empPwd}</div>
	                <div class="col-2">${emp.empStatus}</div>
	                <div class="col-2">
	                    <a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-edit">修改</a>
	                    <a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-delete">刪除</a>
	                    <a href="admin-guest-detail.html" class="btn btn-sm btn-light mb-0 btn-funtion">員工權限</a>
	                </div>
	            `;

					allEmployeesTable.appendChild(empRow);
				});
			})
			.catch(error => {
				console.error('There was a problem with the fetch operation:', error.message);
			});
	});

	//刪除員工
	//使用事件代理來捕獲 btn-delete 的點擊事件
allEmployeesTable.addEventListener("click", function (event) {
	//記得標註辨識btn-delete的類別value
	if (event.target.getAttribute('value') === "btn-delete") {
		event.preventDefault();
		const empNo = event.target.closest('.employee-row').querySelector('.empNo').textContent;
		if (confirm('確定要刪除該員工嗎？')) {
			const formData = new FormData()
			formData.append("empNo", empNo)
			formData.append("action", 'btn-delete')
			//此段為關鍵，對應的位置與關鍵詞需再三確認
			fetch("/flyday/emp/controller", {
				method: 'POST',
				headers: {
					"Content-Type": "application/json",
				},
				body: JSON.stringify({
					empNo: empNo,
					action: "btn-delete"
				})
			})
				.then(response => {
					if (!response.ok) {
						throw new Error("刪除操作出現異常");
					}
					return response.json();
				})
				.then(data => {
					if (data.success) {
						alert('員工已刪除！');
						// 刪除員工行
						event.target.closest('.employee-row').remove();
					} else {
						alert('刪除失敗！');
					}
				})
				.catch(error => console.error('刪除錯誤:', error));
		}
	}
	//修改員工資料
	if (event.target.getAttribute('value') === "btn-edit") {
		event.preventDefault();

		const empRow = event.target.closest('.employee-row');
		const empNo = empRow.querySelector('.empNo').textContent;
		//測試數值用
// 		console.log(empNo, empRow.children[1].textContent, empRow.children[2].textContent, empRow.children[3].textContent,empRow.children[4].textContent,);

		// 保存當前的數據，以便取消修改時可以恢復
		
		currentData.empNo = empNo;
		currentData.empName = empRow.children[1].textContent;
		currentData.empAcc = empRow.children[2].textContent;
		currentData.empPwd = empRow.children[3].textContent;
		currentData.empStatus = empRow.children[4].textContent;

		

		// 將文本轉為輸入框
		empRow.children[1].innerHTML = `<input type="text" value="${currentData.empName}" class="edit-empName">`;
		empRow.children[2].innerHTML = `<input type="text" value="${currentData.empAcc}" class="edit-empAcc">`;
		empRow.children[3].innerHTML = `<input type="text" value="${currentData.empPwd}" class="edit-empPwd">`;
		empRow.children[4].innerHTML = `<input type="text" value="${currentData.empStatus}" class="edit-empStatus">`;
		// 替換 "修改"、"刪除" 和 "員工權限" 按鈕為 "儲存" 和 "取消" 按鈕
		empRow.children[5].innerHTML = `
<a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-save">儲存</a>
<a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-cancel">取消</a>
`;
	} else if (event.target.getAttribute('value') === "btn-save") {
		// 儲存修改的資料，這裡你可能需要發送到後端保存
		event.preventDefault();

		const empRow = event.target.closest('.employee-row');
		const empNo = empRow.querySelector('.empNo').textContent;
		const empName = empRow.children[1].querySelector('input').value;
		const empAcc = empRow.children[2].querySelector('input').value;
		const empPwd = empRow.children[3].querySelector('input').value;
		const empStatus = empRow.children[4].querySelector('input').value;

		// 使用fetch發送請求更新數據
		fetch("/flyday/emp/controller", {
			method: "POST",
			headers: {
				"Content-Type": "application/json"
			},
			body: JSON.stringify({
				
				empNo: empNo,
				empName: empName,
				empAcc: empAcc,
				empPwd: empPwd,
				empStatus: empStatus,
				action: "btn-save"
			})
		})
		
			.then(response => {
				if (!response.ok) {
					throw new Error('網路連線異常，請確認網路通暢');
				}
				return response.json();
			})
			.then(data => {
				if (data.success) {
					alert('員工資料已更新！');

// 					從輸入框中獲取新的資料
						const updatedData = {
							empNo: empRow.querySelector('.empNo').textContent,
							empName: empRow.querySelector('.edit-empName').value,
							empAcc: empRow.querySelector('.edit-empAcc').value,
							empPwd: empRow.querySelector('.edit-empPwd').value,
							empStatus: empRow.querySelector('.edit-empStatus').value,

						};
// 					你可以使用 updatedData 將更新的資料發送到後端

// 					更新界面上的數據
					empRow.children[1].textContent = updatedData.empName;
					empRow.children[2].textContent = updatedData.empAcc;
					empRow.children[3].textContent = updatedData.empPwd;
					empRow.children[4].textContent = updatedData.empStatus;

					// 將 "儲存" 和 "取消" 按鈕替換回 "修改"、"刪除" 和 "員工權限" 按鈕
					empRow.children[5].innerHTML = `
		<a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-edit">修改</a>
		<a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-delete">刪除</a>
		<a href="admin-guest-detail.html" class="btn btn-sm btn-light mb-0 btn-funtion">員工權限</a>
	`;
				} else {
					alert('資料更新失敗！');
				}
			})
			.catch(error => {
				console.error('There was a problem with the fetch operation:', error.message);
			});
	} else if (event.target.getAttribute('value') === "btn-cancel") {
		// 取消修改，恢復原始數據
		event.preventDefault();
// 		console.log(currentData);  測試數值用
		const empRow = event.target.closest('.employee-row');
		
		empRow.children[1].textContent = currentData.empName;
		empRow.children[2].textContent = currentData.empAcc;
		empRow.children[3].textContent = currentData.empPwd;
		empRow.children[4].textContent = currentData.empStatus;
		
		// 將 "儲存" 和 "取消" 按鈕替換回 "修改"、"刪除" 和 "員工權限" 按鈕
		empRow.children[5].innerHTML = `
	  <a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-edit">修改</a>
	  <a href="#" class="btn btn-sm btn-light mb-0" name="action" value="btn-delete">刪除</a>
		<a href="admin-guest-detail.html" class="btn btn-sm btn-light mb-0 btn-funtion">員工權限</a>
		`;
	}


});
	
	
	
	
</script>

</body>
</html>